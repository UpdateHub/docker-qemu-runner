env:
  global:
  - secure: ax2VlpltJsV6sr/rsl0ol1JolqyJYKd3JNQu7esUTH9IIy8U8age9pQQ7ap7c0hrksZ7ypej+TJ+2JC8zRg+2vVgu7ZW4iWxlSP4QOF3dgaDgSbiIW7LNXR4W/HhYmiDAAPIHoQLEtsseXMGOvZkeQ0RnUaFJYCWuT1m2TMRbVZe71pKOOhTqbPSkAxSWnah+DNfAUT0iJLYFkyDrYk2l0V1cIlIJf0D8LsIJ3lEACfRCrq6qXrDIbS0S320SKlB7Be3jsorAbdsT4vS1MI4zGKwuaaDeBY2X3P0NKMHjjHPWERkJzqFtJwz6SxSkDDhYcq7n1bBJSrb7wWaP9rto8cRXByZyI04MyXlIsBnWWtKmvGGrUM+xTBDRbmksgP6x+pJoeG4sDKBA1oJJnUAg5KE2W2ahefO85BUbc07mes/U9qW5JmVZcPdGHxBF81Ecq9GpIPJGSvosbg60XxRVaf2UsHvUGlbnhiCHP90g2cf4/wF0vI1GUPHZ0LbqRz4K0M28qIj4EF4J9YifXMhBijbC15tzTJhBD+uny1IOh7c22/9cJT4VC6agnoFp8RIuPLAm00QGu+V9NYdqDF2k5SD9SIA95NTs5+3+K5nibWz+F0EYx6AD/FXELEB6AczNA4LriiQK8ftniAwAAQorushzubLiTz61gE7x9duM/Q=
  - secure: u1Jmf3eRjmE/9H+RLwxMvZze2mhKEE4lp7vQ9/Y5GQKCoxgeXAnvIYBd+JjM257rHAigIpmIVUUA+tPK9hCFAfcNbNmR3IzDLPatAFd7JyuuIIJJmX/cvBw4hhrxJ4LkavEmijXtDiQPkGNpGSVWPx4TVVen4Yhk8S+OgxqX9lSuv7JZE91p6o6Wykr7uzMk2rD20vP2LzFAPYOjpjap0BmbQu+qoTTya/NM2xEn88lzv+xpR7zElMg7EZMgVVRMZl0W2uLxF1RLIcKs5JWeqW5LPG0PD2M3sY/BnoYsLNrzVzN2JOnIZQHDs6hXnDAcRkYdpiIDn+95Klw3ammPXsOs9I8kUiclSlyvOutsQ2d6lgamxolDVlcq/CszKdfA+jwz6xUZc2T3KZ1owPrJiUeuYHpm0NGLllEUhM5Ois0iqSNO+GRAYNeJGcZoXUL2EJ6zOUUZk6F+53HeaWrTFizjZzxKEs2Azjwo/rgaAgGOOWjhNI0rcctQM+jOibJVer5Dy8gJ+rQ1J2emb+Nsz40mwVYIM+6jiGO/ckuV8tRhRfhidCx8YITbS9Vul04cxg+6PX979ES3r9Ss7IoBCpuqTEYwDw/kv6UYIGKTVFuG8b2MkpPsUmniL9o85TEanERr6NN5f95oQumiQWwNglQNGhJGzqvo2UjG92RClUY=
  - secure: 6RJLiFpV6KzYsOpAf0lbnMxci09nDYXxINm4k5voTrq9i2qrcdbkbSKEWgJ477Tj9jOmIG4efcIwcbvo7eRMFeLwI9+V0o8ewAk//C9FyWFgKLthq8VzBMiwiRA4bWoSxMrvgixoZgfKNAUNvVXuaWI+R0x7Ag3p9oUWX5IwWBmucLai2TMJtbnVPJGoe2pIyAgj8CgGnYsMY9CYZsf1YgzrCULbGZ8cMz2sBdBcAH10JJmuwmSd6kgUR9yZc5yLsNkVhoq1KSi711rvFDXk5YpYVsVuayrziDqMFTJRSHKz74DtF6EzKFTGi+eWb/FcgF5bKdkuPuFLtTDTHzLiEZ3RjzF8GaEXKEGR1Sh3p57lFJIfNZYKHQXFPdT4Ir/0CI3dm7DJIm3m/HDDCcpy8NxPhKW7dfa5xkptqmiHLgjXqU5LXeY5/rlV5RHsgPzm2zDJH9n2KkaRxMmU3olJ2uNK6clraHk+CceJkeT/1UXQDig5DdAvG/+rvRwLsTwpUhAcxOJ0v/JUTAJePK7A2Z/RsMTILm0dg8FdjB8qmgPr59s6oN1UjchV9UBUi2Ofsw09piSFaXZVmQxBqR02J5CHtsVT+y4OE1BeueFJqVf3GAUmQxBmoKFepwWf9gYTLssEjF3Sypl9Bo8C+ar412g0LcVWYqm0R4SxiEug4xI=
  - COMMIT=${TRAVIS_COMMIT::8}

services:
  - docker
  
install: true

script:
  - docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASS
  - export REPO=updatehub/qemu-runner
  - export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH ; fi`
  - docker build -f Dockerfile -t $REPO:$COMMIT .
  - docker tag $REPO:$COMMIT $REPO:$TAG
  - docker tag $REPO:$COMMIT $REPO:travis-$TRAVIS_BUILD_NUMBER
  - docker push $REPO
